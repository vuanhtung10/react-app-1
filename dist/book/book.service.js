'use strict';var _0x4bcfb1=_0x4e23;function _0x9fbc(){var _0x536525=['create','function','4242syxoNN','name','mongoose','Book\x20với\x20id\x20=\x20','__decorate','update','find','BadRequestException','5362698qgcQEo','Model','design:paramtypes','exec','@nestjs/common','\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.','api-query-params','object','length','17660ijmNny','filter','4425lLZVXn','5280730vsdrEV','assign','model','defineProperty','963gaDkpT','16730mzMQXP','updateImageBook','updateOne','metadata','ceil','2527672esyHZW','findById','findAll','sort','__importDefault','decorate','204206STBRyo','slider','Injectable','default','__metadata','3PjLzhe','skip','8dHAhjQ','__esModule','populate','BookService'];_0x9fbc=function(){return _0x536525;};return _0x9fbc();}(function(_0x478051,_0x5d65ad){var _0x50717c=_0x4e23,_0x272952=_0x478051();while(!![]){try{var _0x422b65=parseInt(_0x50717c(0x109))/0x1*(parseInt(_0x50717c(0x110))/0x2)+-parseInt(_0x50717c(0x10e))/0x3*(parseInt(_0x50717c(0xf6))/0x4)+parseInt(_0x50717c(0xf8))/0x5*(-parseInt(_0x50717c(0x116))/0x6)+-parseInt(_0x50717c(0xf9))/0x7+parseInt(_0x50717c(0x103))/0x8+parseInt(_0x50717c(0xfd))/0x9*(parseInt(_0x50717c(0xfe))/0xa)+parseInt(_0x50717c(0xed))/0xb;if(_0x422b65===_0x5d65ad)break;else _0x272952['push'](_0x272952['shift']());}catch(_0x192718){_0x272952['push'](_0x272952['shift']());}}}(_0x9fbc,0x6545c));function _0x4e23(_0x209cc9,_0x46f3b8){var _0x9fbc64=_0x9fbc();return _0x4e23=function(_0x4e23c5,_0x18b159){_0x4e23c5=_0x4e23c5-0xe7;var _0x559ab4=_0x9fbc64[_0x4e23c5];return _0x559ab4;},_0x4e23(_0x209cc9,_0x46f3b8);}var __decorate=this&&this[_0x4bcfb1(0xe9)]||function(_0x376eda,_0x4c70a5,_0x2750a1,_0x26d1cf){var _0x41f782=_0x4bcfb1,_0x15610a,_0x529722=arguments[_0x41f782(0xf5)],_0x4d3420=_0x529722<0x3?_0x4c70a5:null===_0x26d1cf?_0x26d1cf=Object['getOwnPropertyDescriptor'](_0x4c70a5,_0x2750a1):_0x26d1cf;if(_0x41f782(0xf4)==typeof Reflect&&_0x41f782(0x115)==typeof Reflect['decorate'])_0x4d3420=Reflect[_0x41f782(0x108)](_0x376eda,_0x4c70a5,_0x2750a1,_0x26d1cf);else{for(var _0x92defb=_0x376eda[_0x41f782(0xf5)]-0x1;0x0<=_0x92defb;_0x92defb--)(_0x15610a=_0x376eda[_0x92defb])&&(_0x4d3420=(_0x529722<0x3?_0x15610a(_0x4d3420):0x3<_0x529722?_0x15610a(_0x4c70a5,_0x2750a1,_0x4d3420):_0x15610a(_0x4c70a5,_0x2750a1))||_0x4d3420);}return 0x3<_0x529722&&_0x4d3420&&Object['defineProperty'](_0x4c70a5,_0x2750a1,_0x4d3420),_0x4d3420;},__metadata=this&&this[_0x4bcfb1(0x10d)]||function(_0x209107,_0x58ca2d){var _0x4f3ee6=_0x4bcfb1;if(_0x4f3ee6(0xf4)==typeof Reflect&&'function'==typeof Reflect[_0x4f3ee6(0x101)])return Reflect['metadata'](_0x209107,_0x58ca2d);},__param=this&&this['__param']||function(_0xb30e63,_0x1cac9c){return function(_0x5f0d44,_0xeb4d18){_0x1cac9c(_0x5f0d44,_0xeb4d18,_0xb30e63);};},__importDefault=this&&this[_0x4bcfb1(0x107)]||function(_0x34137c){var _0x1213c9=_0x4bcfb1;return _0x34137c&&_0x34137c[_0x1213c9(0x111)]?_0x34137c:{'default':_0x34137c};};Object[_0x4bcfb1(0xfc)](exports,_0x4bcfb1(0x111),{'value':!0x0}),exports[_0x4bcfb1(0x113)]=void 0x0;const common_1=require(_0x4bcfb1(0xf1)),book_schema_1=require('./schemas/book.schema'),mongoose_1=require('@nestjs/mongoose'),mongoose_2=require(_0x4bcfb1(0xe7)),api_query_params_1=__importDefault(require(_0x4bcfb1(0xf3)));let BookService=class{constructor(_0x52dede){this['model']=_0x52dede;}async[_0x4bcfb1(0x114)](_0x531905){var _0x55b65b=_0x4bcfb1;return this[_0x55b65b(0xfb)][_0x55b65b(0x114)](Object[_0x55b65b(0xfa)](Object[_0x55b65b(0xfa)]({},_0x531905),{'updatedAt':new Date(),'createdAt':new Date()}));}async[_0x4bcfb1(0x105)](_0x43b2a9,_0x14a3da,_0xcad722){var _0x187f8e=_0x4bcfb1,_0x3746ca,_0x21ec11,_0x226cdd,_0x362b86,_0x4d7eb1,_0x28fc0a;return _0x14a3da?({filter:_0x43b2a9,sort:_0x3746ca,projection:_0x21ec11,population:_0x226cdd}=(0x0,api_query_params_1[_0x187f8e(0x10c)])(_0x43b2a9),_0x362b86=(+_0x14a3da-0x1)*+_0xcad722,_0x4d7eb1=+_0xcad722||0xa,_0x28fc0a=(await this[_0x187f8e(0xfb)]['find'](_0x43b2a9))['length'],{'meta':{'current':_0x14a3da,'pageSize':_0xcad722,'pages':Math[_0x187f8e(0x102)](_0x28fc0a/_0x4d7eb1),'total':_0x28fc0a},'result':await this['model'][_0x187f8e(0xeb)](_0x43b2a9)[_0x187f8e(0x10f)](_0x362b86)['limit'](_0x4d7eb1)[_0x187f8e(0x106)](_0x3746ca)[_0x187f8e(0x112)](_0x226cdd)[_0x187f8e(0xf0)]()}):await this[_0x187f8e(0xfb)][_0x187f8e(0xeb)]({})[_0x187f8e(0xf0)]();}async['findOne'](_0x1cf687){var _0xa88810=_0x4bcfb1,_0x5baa33=await this[_0xa88810(0xfb)][_0xa88810(0x104)](_0x1cf687);if(_0x5baa33)return _0x5baa33;throw new common_1[(_0xa88810(0xec))](_0xa88810(0xe8)+_0x1cf687+'\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.');}async[_0x4bcfb1(0xea)](_0xd31291,_0x1098fb){var _0x5d6492=_0x4bcfb1;if(await this[_0x5d6492(0xfb)]['findById'](_0xd31291))return this[_0x5d6492(0xfb)][_0x5d6492(0x100)]({'_id':_0xd31291},Object[_0x5d6492(0xfa)](Object['assign']({},_0x1098fb),{'updatedAt':new Date()}));throw new common_1[(_0x5d6492(0xec))](_0x5d6492(0xe8)+_0xd31291+'\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.');}async['remove'](_0x5f50df){var _0x53da7a=_0x4bcfb1;if(await this[_0x53da7a(0xfb)]['findById'](_0x5f50df))return this[_0x53da7a(0xfb)]['deleteOne']({'_id':_0x5f50df});throw new common_1[(_0x53da7a(0xec))](_0x53da7a(0xe8)+_0x5f50df+'\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.');}async[_0x4bcfb1(0xff)](_0x1d7f78,_0x87990b,_0x4b569a){var _0xcd0b7e=_0x4bcfb1,_0x29940d=await this['model']['findById'](_0x1d7f78);if(_0x29940d)return _0xcd0b7e(0x10a)===_0x87990b?this[_0xcd0b7e(0xfb)]['updateOne']({'_id':_0x1d7f78},{'slider':[..._0x29940d[_0xcd0b7e(0x10a)],_0x4b569a],'updatedAt':new Date()}):this[_0xcd0b7e(0xfb)][_0xcd0b7e(0x100)]({'_id':_0x1d7f78},{'thumbnail':_0x4b569a,'updatedAt':new Date()});throw new common_1[(_0xcd0b7e(0xec))](_0xcd0b7e(0xe8)+_0x1d7f78+_0xcd0b7e(0xf2));}async['deleteAnImage'](_0x7bdaf0,_0x455c5b,_0x34e12b){var _0x3c0a99=_0x4bcfb1,_0xd3ae3b=await this[_0x3c0a99(0xfb)][_0x3c0a99(0x104)](_0x7bdaf0);if(_0xd3ae3b)return'slider'===_0x34e12b?this['model'][_0x3c0a99(0x100)]({'_id':_0x7bdaf0},{'slider':_0xd3ae3b[_0x3c0a99(0x10a)][_0x3c0a99(0xf7)](_0x458a92=>_0x458a92!==_0x455c5b),'updatedAt':new Date()}):this['model'][_0x3c0a99(0x100)]({'_id':_0x7bdaf0},{'thumbnail':'','updatedAt':new Date()});throw new common_1[(_0x3c0a99(0xec))](_0x3c0a99(0xe8)+_0x7bdaf0+'\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.');}};BookService=__decorate([(0x0,common_1[_0x4bcfb1(0x10b)])(),__param(0x0,(0x0,mongoose_1['InjectModel'])(book_schema_1['Book'][_0x4bcfb1(0x117)])),__metadata(_0x4bcfb1(0xef),[mongoose_2[_0x4bcfb1(0xee)]])],BookService),exports['BookService']=BookService;